sudo: false

env:
  global:
    - secure: fxJPfu/icH+3w9nRcedFtqNumnpmo1vWAA7HBaeeCF0vnzTHBbD2ej3olyaDmFoJ9PaW84q5UKX3iU6BBXLmlestOZCcfQ9nDvVuIVpimIovO7QuZhnRYea0SaSRcXEgNE+nWEcsiiKWuVUnDEXAUQRCs04YQpAvgsUjMcZgXQw=

cache:
  apt: true
  directories:
    - ~/.stack

branches:
  only:
    - master
    - develop

before_install:
    - export PATH=/opt/ghc/$GHCVER/bin:$PATH
    - export PATH=~/.local/bin:$PATH
    - ./script/travis-lifecycle-before_install

install:
    - ./script/travis-lifecycle-install

script:
    - ./script/travis-lifecycle-script

matrix:
  fast_finish: true
  allow_failures:
    # This is due to the constant GHC ExitFailure (-9) that occurs on
    # the non-GCE/container infrastructure.
    - env: GHCVER=8.0.1 LIBRARY=documentation

  include:
    # Below is auto-generated by ./scripts/travis-matrix >> .travis.yml

    # Documentation
    - env: GHCVER=8.0.1 LIBRARY=documentation
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }

    # Core
    - env: GHCVER=8.0.1 LIBRARY=amazonka-core
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=7.10.3 LIBRARY=amazonka-core
      addons: { apt: { packages: [ghc-7.10.3], sources: [hvr-ghc] } }
    - env: GHCVER=7.8.4 LIBRARY=amazonka-core
      addons: { apt: { packages: [ghc-7.8.4], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=7.10.3 LIBRARY=amazonka
      addons: { apt: { packages: [ghc-7.10.3], sources: [hvr-ghc] } }
    - env: GHCVER=7.8.4 LIBRARY=amazonka
      addons: { apt: { packages: [ghc-7.8.4], sources: [hvr-ghc] } }

    # Test
    - env: GHCVER=8.0.1 LIBRARY=amazonka-test
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }

    # Priority
    - env: GHCVER=8.0.1 LIBRARY=amazonka-s3
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=7.10.3 LIBRARY=amazonka-s3
      addons: { apt: { packages: [ghc-7.10.3], sources: [hvr-ghc] } }
    - env: GHCVER=7.8.4 LIBRARY=amazonka-s3
      addons: { apt: { packages: [ghc-7.8.4], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-autoscaling
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=7.10.3 LIBRARY=amazonka-autoscaling
      addons: { apt: { packages: [ghc-7.10.3], sources: [hvr-ghc] } }
    - env: GHCVER=7.8.4 LIBRARY=amazonka-autoscaling
      addons: { apt: { packages: [ghc-7.8.4], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-elb
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=7.10.3 LIBRARY=amazonka-elb
      addons: { apt: { packages: [ghc-7.10.3], sources: [hvr-ghc] } }
    - env: GHCVER=7.8.4 LIBRARY=amazonka-elb
      addons: { apt: { packages: [ghc-7.8.4], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-sqs
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=7.10.3 LIBRARY=amazonka-sqs
      addons: { apt: { packages: [ghc-7.10.3], sources: [hvr-ghc] } }
    - env: GHCVER=7.8.4 LIBRARY=amazonka-sqs
      addons: { apt: { packages: [ghc-7.8.4], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-iam
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=7.10.3 LIBRARY=amazonka-iam
      addons: { apt: { packages: [ghc-7.10.3], sources: [hvr-ghc] } }
    - env: GHCVER=7.8.4 LIBRARY=amazonka-iam
      addons: { apt: { packages: [ghc-7.8.4], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-ec2
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=7.10.3 LIBRARY=amazonka-ec2
      addons: { apt: { packages: [ghc-7.10.3], sources: [hvr-ghc] } }
    - env: GHCVER=7.8.4 LIBRARY=amazonka-ec2
      addons: { apt: { packages: [ghc-7.8.4], sources: [hvr-ghc] } }

    # Remainder
    - env: GHCVER=8.0.1 LIBRARY=amazonka-apigateway
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-application-autoscaling
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-certificatemanager
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cloudformation
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cloudfront
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cloudhsm
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cloudsearch
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cloudsearch-domains
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cloudtrail
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cloudwatch
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cloudwatch-events
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cloudwatch-logs
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-codecommit
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-codedeploy
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-codepipeline
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cognito-identity
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cognito-idp
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-cognito-sync
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-config
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-datapipeline
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-devicefarm
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-directconnect
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-discovery
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-dms
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-ds
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-dynamodb
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-dynamodb-streams
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-ecr
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-ecs
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-efs
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-elasticache
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-elasticbeanstalk
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-elasticsearch
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-elastictranscoder
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-emr
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-gamelift
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-glacier
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-importexport
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-inspector
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-iot
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-iot-dataplane
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-kinesis
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-kinesis-firehose
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-kms
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-lambda
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-marketplace-analytics
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-marketplace-metering
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-ml
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-opsworks
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-rds
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-redshift
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-route53
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-route53-domains
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-sdb
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-ses
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-sns
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-ssm
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-storagegateway
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-sts
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-support
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-swf
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-waf
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
    - env: GHCVER=8.0.1 LIBRARY=amazonka-workspaces
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }

    # Examples
    - env: GHCVER=8.0.1 LIBRARY=amazonka-examples
      addons: { apt: { packages: [ghc-8.0.1], sources: [hvr-ghc] } }
