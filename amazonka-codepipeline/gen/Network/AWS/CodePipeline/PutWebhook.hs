{-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE DuplicateRecordFields #-}
{-# LANGUAGE NamedFieldPuns #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE RecordWildCards #-}
{-# LANGUAGE StrictData #-}
{-# LANGUAGE TypeFamilies #-}
{-# LANGUAGE NoImplicitPrelude #-}
{-# OPTIONS_GHC -fno-warn-unused-binds #-}
{-# OPTIONS_GHC -fno-warn-unused-imports #-}
{-# OPTIONS_GHC -fno-warn-unused-matches #-}

-- Derived from AWS service descriptions, licensed under Apache 2.0.

-- |
-- Module      : Network.AWS.CodePipeline.PutWebhook
-- Copyright   : (c) 2013-2021 Brendan Hay
-- License     : Mozilla Public License, v. 2.0.
-- Maintainer  : Brendan Hay <brendan.g.hay+amazonka@gmail.com>
-- Stability   : auto-generated
-- Portability : non-portable (GHC extensions)
--
-- Defines a webhook and returns a unique webhook URL generated by
-- CodePipeline. This URL can be supplied to third party source hosting
-- providers to call every time there\'s a code change. When CodePipeline
-- receives a POST request on this URL, the pipeline defined in the webhook
-- is started as long as the POST request satisfied the authentication and
-- filtering requirements supplied when defining the webhook.
-- RegisterWebhookWithThirdParty and DeregisterWebhookWithThirdParty APIs
-- can be used to automatically configure supported third parties to call
-- the generated webhook URL.
module Network.AWS.CodePipeline.PutWebhook
  ( -- * Creating a Request
    PutWebhook (..),
    newPutWebhook,

    -- * Request Lenses
    putWebhook_tags,
    putWebhook_webhook,

    -- * Destructuring the Response
    PutWebhookResponse (..),
    newPutWebhookResponse,

    -- * Response Lenses
    putWebhookResponse_webhook,
    putWebhookResponse_httpStatus,
  )
where

import Network.AWS.CodePipeline.Types
import qualified Network.AWS.Core as Core
import qualified Network.AWS.Lens as Lens
import qualified Network.AWS.Request as Request
import qualified Network.AWS.Response as Response

-- | /See:/ 'newPutWebhook' smart constructor.
data PutWebhook = PutWebhook'
  { -- | The tags for the webhook.
    tags :: Core.Maybe [Tag],
    -- | The detail provided in an input file to create the webhook, such as the
    -- webhook name, the pipeline name, and the action name. Give the webhook a
    -- unique name that helps you identify it. You might name the webhook after
    -- the pipeline and action it targets so that you can easily recognize what
    -- it\'s used for later.
    webhook :: WebhookDefinition
  }
  deriving (Core.Eq, Core.Read, Core.Show, Core.Generic)

-- |
-- Create a value of 'PutWebhook' with all optional fields omitted.
--
-- Use <https://hackage.haskell.org/package/generic-lens generic-lens> or <https://hackage.haskell.org/package/optics optics> to modify other optional fields.
--
-- The following record fields are available, with the corresponding lenses provided
-- for backwards compatibility:
--
-- 'tags', 'putWebhook_tags' - The tags for the webhook.
--
-- 'webhook', 'putWebhook_webhook' - The detail provided in an input file to create the webhook, such as the
-- webhook name, the pipeline name, and the action name. Give the webhook a
-- unique name that helps you identify it. You might name the webhook after
-- the pipeline and action it targets so that you can easily recognize what
-- it\'s used for later.
newPutWebhook ::
  -- | 'webhook'
  WebhookDefinition ->
  PutWebhook
newPutWebhook pWebhook_ =
  PutWebhook'
    { tags = Core.Nothing,
      webhook = pWebhook_
    }

-- | The tags for the webhook.
putWebhook_tags :: Lens.Lens' PutWebhook (Core.Maybe [Tag])
putWebhook_tags = Lens.lens (\PutWebhook' {tags} -> tags) (\s@PutWebhook' {} a -> s {tags = a} :: PutWebhook) Core.. Lens.mapping Lens._Coerce

-- | The detail provided in an input file to create the webhook, such as the
-- webhook name, the pipeline name, and the action name. Give the webhook a
-- unique name that helps you identify it. You might name the webhook after
-- the pipeline and action it targets so that you can easily recognize what
-- it\'s used for later.
putWebhook_webhook :: Lens.Lens' PutWebhook WebhookDefinition
putWebhook_webhook = Lens.lens (\PutWebhook' {webhook} -> webhook) (\s@PutWebhook' {} a -> s {webhook = a} :: PutWebhook)

instance Core.AWSRequest PutWebhook where
  type AWSResponse PutWebhook = PutWebhookResponse
  request = Request.postJSON defaultService
  response =
    Response.receiveJSON
      ( \s h x ->
          PutWebhookResponse'
            Core.<$> (x Core..?> "webhook")
            Core.<*> (Core.pure (Core.fromEnum s))
      )

instance Core.Hashable PutWebhook

instance Core.NFData PutWebhook

instance Core.ToHeaders PutWebhook where
  toHeaders =
    Core.const
      ( Core.mconcat
          [ "X-Amz-Target"
              Core.=# ( "CodePipeline_20150709.PutWebhook" ::
                          Core.ByteString
                      ),
            "Content-Type"
              Core.=# ("application/x-amz-json-1.1" :: Core.ByteString)
          ]
      )

instance Core.ToJSON PutWebhook where
  toJSON PutWebhook' {..} =
    Core.object
      ( Core.catMaybes
          [ ("tags" Core..=) Core.<$> tags,
            Core.Just ("webhook" Core..= webhook)
          ]
      )

instance Core.ToPath PutWebhook where
  toPath = Core.const "/"

instance Core.ToQuery PutWebhook where
  toQuery = Core.const Core.mempty

-- | /See:/ 'newPutWebhookResponse' smart constructor.
data PutWebhookResponse = PutWebhookResponse'
  { -- | The detail returned from creating the webhook, such as the webhook name,
    -- webhook URL, and webhook ARN.
    webhook :: Core.Maybe ListWebhookItem,
    -- | The response's http status code.
    httpStatus :: Core.Int
  }
  deriving (Core.Eq, Core.Read, Core.Show, Core.Generic)

-- |
-- Create a value of 'PutWebhookResponse' with all optional fields omitted.
--
-- Use <https://hackage.haskell.org/package/generic-lens generic-lens> or <https://hackage.haskell.org/package/optics optics> to modify other optional fields.
--
-- The following record fields are available, with the corresponding lenses provided
-- for backwards compatibility:
--
-- 'webhook', 'putWebhookResponse_webhook' - The detail returned from creating the webhook, such as the webhook name,
-- webhook URL, and webhook ARN.
--
-- 'httpStatus', 'putWebhookResponse_httpStatus' - The response's http status code.
newPutWebhookResponse ::
  -- | 'httpStatus'
  Core.Int ->
  PutWebhookResponse
newPutWebhookResponse pHttpStatus_ =
  PutWebhookResponse'
    { webhook = Core.Nothing,
      httpStatus = pHttpStatus_
    }

-- | The detail returned from creating the webhook, such as the webhook name,
-- webhook URL, and webhook ARN.
putWebhookResponse_webhook :: Lens.Lens' PutWebhookResponse (Core.Maybe ListWebhookItem)
putWebhookResponse_webhook = Lens.lens (\PutWebhookResponse' {webhook} -> webhook) (\s@PutWebhookResponse' {} a -> s {webhook = a} :: PutWebhookResponse)

-- | The response's http status code.
putWebhookResponse_httpStatus :: Lens.Lens' PutWebhookResponse Core.Int
putWebhookResponse_httpStatus = Lens.lens (\PutWebhookResponse' {httpStatus} -> httpStatus) (\s@PutWebhookResponse' {} a -> s {httpStatus = a} :: PutWebhookResponse)

instance Core.NFData PutWebhookResponse
