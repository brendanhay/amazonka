{-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE DuplicateRecordFields #-}
{-# LANGUAGE NamedFieldPuns #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE RecordWildCards #-}
{-# LANGUAGE StrictData #-}
{-# LANGUAGE NoImplicitPrelude #-}
{-# OPTIONS_GHC -fno-warn-unused-imports #-}
{-# OPTIONS_GHC -fno-warn-unused-matches #-}

-- Derived from AWS service descriptions, licensed under Apache 2.0.

-- |
-- Module      : Amazonka.Inspector2.Types.Vulnerability
-- Copyright   : (c) 2013-2023 Brendan Hay
-- License     : Mozilla Public License, v. 2.0.
-- Maintainer  : Brendan Hay <brendan.g.hay+amazonka@gmail.com>
-- Stability   : auto-generated
-- Portability : non-portable (GHC extensions)
module Amazonka.Inspector2.Types.Vulnerability where

import qualified Amazonka.Core as Core
import qualified Amazonka.Core.Lens.Internal as Lens
import qualified Amazonka.Data as Data
import Amazonka.Inspector2.Types.AtigData
import Amazonka.Inspector2.Types.CisaData
import Amazonka.Inspector2.Types.Cvss2
import Amazonka.Inspector2.Types.Cvss3
import Amazonka.Inspector2.Types.Epss
import Amazonka.Inspector2.Types.ExploitObserved
import Amazonka.Inspector2.Types.VulnerabilitySource
import qualified Amazonka.Prelude as Prelude

-- | Contains details about a specific vulnerability Amazon Inspector can
-- detect.
--
-- /See:/ 'newVulnerability' smart constructor.
data Vulnerability = Vulnerability'
  { -- | An object that contains information about the Amazon Web Services Threat
    -- Intel Group (ATIG) details for the vulnerability.
    atigData :: Prelude.Maybe AtigData,
    -- | An object that contains the Cybersecurity and Infrastructure Security
    -- Agency (CISA) details for the vulnerability.
    cisaData :: Prelude.Maybe CisaData,
    -- | An object that contains the Common Vulnerability Scoring System (CVSS)
    -- Version 2 details for the vulnerability.
    cvss2 :: Prelude.Maybe Cvss2,
    -- | An object that contains the Common Vulnerability Scoring System (CVSS)
    -- Version 3 details for the vulnerability.
    cvss3 :: Prelude.Maybe Cvss3,
    -- | The Common Weakness Enumeration (CWE) associated with the vulnerability.
    cwes :: Prelude.Maybe [Prelude.Text],
    -- | A description of the vulnerability.
    description :: Prelude.Maybe Prelude.Text,
    -- | Platforms that the vulnerability can be detected on.
    detectionPlatforms :: Prelude.Maybe [Prelude.Text],
    -- | An object that contains the Exploit Prediction Scoring System (EPSS)
    -- score for a vulnerability.
    epss :: Prelude.Maybe Epss,
    -- | An object that contains details on when the exploit was observed.
    exploitObserved :: Prelude.Maybe ExploitObserved,
    -- | Links to various resources with more information on this vulnerability.
    referenceUrls :: Prelude.Maybe [Prelude.Text],
    -- | A list of related vulnerabilities.
    relatedVulnerabilities :: Prelude.Maybe [Prelude.Text],
    -- | The source of the vulnerability information.
    source :: Prelude.Maybe VulnerabilitySource,
    -- | A link to the official source material for this vulnerability.
    sourceUrl :: Prelude.Maybe Prelude.Text,
    -- | The date and time when the vendor created this vulnerability.
    vendorCreatedAt :: Prelude.Maybe Data.POSIX,
    -- | The severity assigned by the vendor.
    vendorSeverity :: Prelude.Maybe Prelude.Text,
    -- | The date and time when the vendor last updated this vulnerability.
    vendorUpdatedAt :: Prelude.Maybe Data.POSIX,
    -- | The ID for the specific vulnerability.
    id :: Prelude.Text
  }
  deriving (Prelude.Eq, Prelude.Read, Prelude.Show, Prelude.Generic)

-- |
-- Create a value of 'Vulnerability' with all optional fields omitted.
--
-- Use <https://hackage.haskell.org/package/generic-lens generic-lens> or <https://hackage.haskell.org/package/optics optics> to modify other optional fields.
--
-- The following record fields are available, with the corresponding lenses provided
-- for backwards compatibility:
--
-- 'atigData', 'vulnerability_atigData' - An object that contains information about the Amazon Web Services Threat
-- Intel Group (ATIG) details for the vulnerability.
--
-- 'cisaData', 'vulnerability_cisaData' - An object that contains the Cybersecurity and Infrastructure Security
-- Agency (CISA) details for the vulnerability.
--
-- 'cvss2', 'vulnerability_cvss2' - An object that contains the Common Vulnerability Scoring System (CVSS)
-- Version 2 details for the vulnerability.
--
-- 'cvss3', 'vulnerability_cvss3' - An object that contains the Common Vulnerability Scoring System (CVSS)
-- Version 3 details for the vulnerability.
--
-- 'cwes', 'vulnerability_cwes' - The Common Weakness Enumeration (CWE) associated with the vulnerability.
--
-- 'description', 'vulnerability_description' - A description of the vulnerability.
--
-- 'detectionPlatforms', 'vulnerability_detectionPlatforms' - Platforms that the vulnerability can be detected on.
--
-- 'epss', 'vulnerability_epss' - An object that contains the Exploit Prediction Scoring System (EPSS)
-- score for a vulnerability.
--
-- 'exploitObserved', 'vulnerability_exploitObserved' - An object that contains details on when the exploit was observed.
--
-- 'referenceUrls', 'vulnerability_referenceUrls' - Links to various resources with more information on this vulnerability.
--
-- 'relatedVulnerabilities', 'vulnerability_relatedVulnerabilities' - A list of related vulnerabilities.
--
-- 'source', 'vulnerability_source' - The source of the vulnerability information.
--
-- 'sourceUrl', 'vulnerability_sourceUrl' - A link to the official source material for this vulnerability.
--
-- 'vendorCreatedAt', 'vulnerability_vendorCreatedAt' - The date and time when the vendor created this vulnerability.
--
-- 'vendorSeverity', 'vulnerability_vendorSeverity' - The severity assigned by the vendor.
--
-- 'vendorUpdatedAt', 'vulnerability_vendorUpdatedAt' - The date and time when the vendor last updated this vulnerability.
--
-- 'id', 'vulnerability_id' - The ID for the specific vulnerability.
newVulnerability ::
  -- | 'id'
  Prelude.Text ->
  Vulnerability
newVulnerability pId_ =
  Vulnerability'
    { atigData = Prelude.Nothing,
      cisaData = Prelude.Nothing,
      cvss2 = Prelude.Nothing,
      cvss3 = Prelude.Nothing,
      cwes = Prelude.Nothing,
      description = Prelude.Nothing,
      detectionPlatforms = Prelude.Nothing,
      epss = Prelude.Nothing,
      exploitObserved = Prelude.Nothing,
      referenceUrls = Prelude.Nothing,
      relatedVulnerabilities = Prelude.Nothing,
      source = Prelude.Nothing,
      sourceUrl = Prelude.Nothing,
      vendorCreatedAt = Prelude.Nothing,
      vendorSeverity = Prelude.Nothing,
      vendorUpdatedAt = Prelude.Nothing,
      id = pId_
    }

-- | An object that contains information about the Amazon Web Services Threat
-- Intel Group (ATIG) details for the vulnerability.
vulnerability_atigData :: Lens.Lens' Vulnerability (Prelude.Maybe AtigData)
vulnerability_atigData = Lens.lens (\Vulnerability' {atigData} -> atigData) (\s@Vulnerability' {} a -> s {atigData = a} :: Vulnerability)

-- | An object that contains the Cybersecurity and Infrastructure Security
-- Agency (CISA) details for the vulnerability.
vulnerability_cisaData :: Lens.Lens' Vulnerability (Prelude.Maybe CisaData)
vulnerability_cisaData = Lens.lens (\Vulnerability' {cisaData} -> cisaData) (\s@Vulnerability' {} a -> s {cisaData = a} :: Vulnerability)

-- | An object that contains the Common Vulnerability Scoring System (CVSS)
-- Version 2 details for the vulnerability.
vulnerability_cvss2 :: Lens.Lens' Vulnerability (Prelude.Maybe Cvss2)
vulnerability_cvss2 = Lens.lens (\Vulnerability' {cvss2} -> cvss2) (\s@Vulnerability' {} a -> s {cvss2 = a} :: Vulnerability)

-- | An object that contains the Common Vulnerability Scoring System (CVSS)
-- Version 3 details for the vulnerability.
vulnerability_cvss3 :: Lens.Lens' Vulnerability (Prelude.Maybe Cvss3)
vulnerability_cvss3 = Lens.lens (\Vulnerability' {cvss3} -> cvss3) (\s@Vulnerability' {} a -> s {cvss3 = a} :: Vulnerability)

-- | The Common Weakness Enumeration (CWE) associated with the vulnerability.
vulnerability_cwes :: Lens.Lens' Vulnerability (Prelude.Maybe [Prelude.Text])
vulnerability_cwes = Lens.lens (\Vulnerability' {cwes} -> cwes) (\s@Vulnerability' {} a -> s {cwes = a} :: Vulnerability) Prelude.. Lens.mapping Lens.coerced

-- | A description of the vulnerability.
vulnerability_description :: Lens.Lens' Vulnerability (Prelude.Maybe Prelude.Text)
vulnerability_description = Lens.lens (\Vulnerability' {description} -> description) (\s@Vulnerability' {} a -> s {description = a} :: Vulnerability)

-- | Platforms that the vulnerability can be detected on.
vulnerability_detectionPlatforms :: Lens.Lens' Vulnerability (Prelude.Maybe [Prelude.Text])
vulnerability_detectionPlatforms = Lens.lens (\Vulnerability' {detectionPlatforms} -> detectionPlatforms) (\s@Vulnerability' {} a -> s {detectionPlatforms = a} :: Vulnerability) Prelude.. Lens.mapping Lens.coerced

-- | An object that contains the Exploit Prediction Scoring System (EPSS)
-- score for a vulnerability.
vulnerability_epss :: Lens.Lens' Vulnerability (Prelude.Maybe Epss)
vulnerability_epss = Lens.lens (\Vulnerability' {epss} -> epss) (\s@Vulnerability' {} a -> s {epss = a} :: Vulnerability)

-- | An object that contains details on when the exploit was observed.
vulnerability_exploitObserved :: Lens.Lens' Vulnerability (Prelude.Maybe ExploitObserved)
vulnerability_exploitObserved = Lens.lens (\Vulnerability' {exploitObserved} -> exploitObserved) (\s@Vulnerability' {} a -> s {exploitObserved = a} :: Vulnerability)

-- | Links to various resources with more information on this vulnerability.
vulnerability_referenceUrls :: Lens.Lens' Vulnerability (Prelude.Maybe [Prelude.Text])
vulnerability_referenceUrls = Lens.lens (\Vulnerability' {referenceUrls} -> referenceUrls) (\s@Vulnerability' {} a -> s {referenceUrls = a} :: Vulnerability) Prelude.. Lens.mapping Lens.coerced

-- | A list of related vulnerabilities.
vulnerability_relatedVulnerabilities :: Lens.Lens' Vulnerability (Prelude.Maybe [Prelude.Text])
vulnerability_relatedVulnerabilities = Lens.lens (\Vulnerability' {relatedVulnerabilities} -> relatedVulnerabilities) (\s@Vulnerability' {} a -> s {relatedVulnerabilities = a} :: Vulnerability) Prelude.. Lens.mapping Lens.coerced

-- | The source of the vulnerability information.
vulnerability_source :: Lens.Lens' Vulnerability (Prelude.Maybe VulnerabilitySource)
vulnerability_source = Lens.lens (\Vulnerability' {source} -> source) (\s@Vulnerability' {} a -> s {source = a} :: Vulnerability)

-- | A link to the official source material for this vulnerability.
vulnerability_sourceUrl :: Lens.Lens' Vulnerability (Prelude.Maybe Prelude.Text)
vulnerability_sourceUrl = Lens.lens (\Vulnerability' {sourceUrl} -> sourceUrl) (\s@Vulnerability' {} a -> s {sourceUrl = a} :: Vulnerability)

-- | The date and time when the vendor created this vulnerability.
vulnerability_vendorCreatedAt :: Lens.Lens' Vulnerability (Prelude.Maybe Prelude.UTCTime)
vulnerability_vendorCreatedAt = Lens.lens (\Vulnerability' {vendorCreatedAt} -> vendorCreatedAt) (\s@Vulnerability' {} a -> s {vendorCreatedAt = a} :: Vulnerability) Prelude.. Lens.mapping Data._Time

-- | The severity assigned by the vendor.
vulnerability_vendorSeverity :: Lens.Lens' Vulnerability (Prelude.Maybe Prelude.Text)
vulnerability_vendorSeverity = Lens.lens (\Vulnerability' {vendorSeverity} -> vendorSeverity) (\s@Vulnerability' {} a -> s {vendorSeverity = a} :: Vulnerability)

-- | The date and time when the vendor last updated this vulnerability.
vulnerability_vendorUpdatedAt :: Lens.Lens' Vulnerability (Prelude.Maybe Prelude.UTCTime)
vulnerability_vendorUpdatedAt = Lens.lens (\Vulnerability' {vendorUpdatedAt} -> vendorUpdatedAt) (\s@Vulnerability' {} a -> s {vendorUpdatedAt = a} :: Vulnerability) Prelude.. Lens.mapping Data._Time

-- | The ID for the specific vulnerability.
vulnerability_id :: Lens.Lens' Vulnerability Prelude.Text
vulnerability_id = Lens.lens (\Vulnerability' {id} -> id) (\s@Vulnerability' {} a -> s {id = a} :: Vulnerability)

instance Data.FromJSON Vulnerability where
  parseJSON =
    Data.withObject
      "Vulnerability"
      ( \x ->
          Vulnerability'
            Prelude.<$> (x Data..:? "atigData")
            Prelude.<*> (x Data..:? "cisaData")
            Prelude.<*> (x Data..:? "cvss2")
            Prelude.<*> (x Data..:? "cvss3")
            Prelude.<*> (x Data..:? "cwes" Data..!= Prelude.mempty)
            Prelude.<*> (x Data..:? "description")
            Prelude.<*> ( x
                            Data..:? "detectionPlatforms"
                            Data..!= Prelude.mempty
                        )
            Prelude.<*> (x Data..:? "epss")
            Prelude.<*> (x Data..:? "exploitObserved")
            Prelude.<*> (x Data..:? "referenceUrls" Data..!= Prelude.mempty)
            Prelude.<*> ( x
                            Data..:? "relatedVulnerabilities"
                            Data..!= Prelude.mempty
                        )
            Prelude.<*> (x Data..:? "source")
            Prelude.<*> (x Data..:? "sourceUrl")
            Prelude.<*> (x Data..:? "vendorCreatedAt")
            Prelude.<*> (x Data..:? "vendorSeverity")
            Prelude.<*> (x Data..:? "vendorUpdatedAt")
            Prelude.<*> (x Data..: "id")
      )

instance Prelude.Hashable Vulnerability where
  hashWithSalt _salt Vulnerability' {..} =
    _salt
      `Prelude.hashWithSalt` atigData
      `Prelude.hashWithSalt` cisaData
      `Prelude.hashWithSalt` cvss2
      `Prelude.hashWithSalt` cvss3
      `Prelude.hashWithSalt` cwes
      `Prelude.hashWithSalt` description
      `Prelude.hashWithSalt` detectionPlatforms
      `Prelude.hashWithSalt` epss
      `Prelude.hashWithSalt` exploitObserved
      `Prelude.hashWithSalt` referenceUrls
      `Prelude.hashWithSalt` relatedVulnerabilities
      `Prelude.hashWithSalt` source
      `Prelude.hashWithSalt` sourceUrl
      `Prelude.hashWithSalt` vendorCreatedAt
      `Prelude.hashWithSalt` vendorSeverity
      `Prelude.hashWithSalt` vendorUpdatedAt
      `Prelude.hashWithSalt` id

instance Prelude.NFData Vulnerability where
  rnf Vulnerability' {..} =
    Prelude.rnf atigData
      `Prelude.seq` Prelude.rnf cisaData
      `Prelude.seq` Prelude.rnf cvss2
      `Prelude.seq` Prelude.rnf cvss3
      `Prelude.seq` Prelude.rnf cwes
      `Prelude.seq` Prelude.rnf description
      `Prelude.seq` Prelude.rnf detectionPlatforms
      `Prelude.seq` Prelude.rnf epss
      `Prelude.seq` Prelude.rnf exploitObserved
      `Prelude.seq` Prelude.rnf referenceUrls
      `Prelude.seq` Prelude.rnf relatedVulnerabilities
      `Prelude.seq` Prelude.rnf source
      `Prelude.seq` Prelude.rnf sourceUrl
      `Prelude.seq` Prelude.rnf vendorCreatedAt
      `Prelude.seq` Prelude.rnf vendorSeverity
      `Prelude.seq` Prelude.rnf vendorUpdatedAt
      `Prelude.seq` Prelude.rnf id
